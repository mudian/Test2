//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "frmMain.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "CPort"
#pragma resource "*.dfm"
TForm2 *Form2;
//---------------------------------------------------------------------------
__fastcall TForm2::TForm2(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm2::close1Click(TObject *Sender)
{
	Close();
}
//---------------------------------------------------------------------------


void __fastcall TForm2::btnConnectClick(TObject *Sender)
{
	if(ComPort1->Connected) 
	{                        
		btnConnect->Down = 0;
		btnConnect->Caption ="Disconnect";
		ComPort1->Close();
	}
	else 
	{
		try{
		btnConnect->Down = 1;
		btnConnect->Caption ="Connect";
//		ComPort1->Port = "COM5";

		ComPort1->Open();

		}catch(...){
			Memo1->Lines->Add("?");
		}
	}
}
//---------------------------------------------------------------------------


void __fastcall TForm2::cbxPortClick(TObject *Sender)
{
/*	//사용 가능한 포트 찾기
	int portl = length(Comport1->PortIndex)
	for(int i=0;i< portl; i++)
	{
	cbxProt->Item[i] = c
	ComPort1

	}
*/
}
//---------------------------------------------------------------------------

void __fastcall TForm2::testOnClick(TObject *Sender)
{

	try{
	ComPort1->WriteStr("commend");
//	ComPort1->ReadStr(StrMsg,1);
	Memo2->Lines->Add("전송시도");

	}catch(...){
	Memo2->Lines->Add("실패");
	}
}
//---------------------------------------------------------------------------









void __fastcall TForm2::testOffClick(TObject *Sender)
{    
	AnsiString StrMsg;

	ComPort1->ReadStr(StrMsg,1);

}
//---------------------------------------------------------------------------

